# JokerGame-Stats
Ανάλυση αποτελεσμάτων παιχνιδιών ΤΖΟΚΕΡ

Υλοποίηση της εφαρμογής JokerGame-Stats, η οποία επεξεργάζεται δεδομένα που λαμβάνει από την υπηρεσία ιστού (web service) που περιγράφονται στην ιστοσελίδα του ΟΠΑΠ https://www.opap.gr/web-services.

Η ΟΠΑΠ ΑΕ παρέχει τις εν λόγω διαδικτυακές υπηρεσίες μέσω web services τύπου REST (Representational State Transfer), προκειμένου να χρησιμοποιηθούν από οποιοδήποτε ενδιαφερόμενο μέρος. Τα σχετικά δεδομένα επιστρέφονται σε μορφή JSON (JavaScript Object Notation).

Ένα API είναι ένας κατάλογος λειτουργιών (operations) με τη μορφή web διευθύνσεων (Uniform Resource Identifiers - URIs) μαζί με τις παραμέτρους κλήσης αυτών (request parameters) των λειτουργιών. Επίσης, ένα API προσδιορίζει τις αναμενόμενες απαντήσεις (responses), ακολουθώντας  την αρχιτεκτονική REST. Συνήθως, η κλήση του API γίνεται από ένα άλλο σύστημα-πελάτη (client) που το χρησιμοποιεί. Συνεπώς, η ζητούμενη εφαρμογή JokerGame-Stats που θα πρέπει να κατασκευαστεί, θα είναι μια εφαρμογή πελάτης, η οποία θα καταναλώνει τα Web Services της ΟΠΑΠ Α.Ε. σχετικά με τα αποτελέσματα του παιχνιδιού Joker. 

Για τη χρήση των web services https://www.opap.gr/web-services δεν απαιτείται η δημιουργία λογαριασμού ή/και API KEY.  Το Swagger αρχείο (σύστημα τεκμηρίωσης) για τα Web Services βρίσκεται στο: https://api.opap.gr/numerics/v1.0/api-swagger

Κατά τη φάση του σχεδιασμού, μας ενδιαφέρει η υλοποίηση ενός γραφικού συστήματος διεπαφής (GUI), το οποίο θα εξυπηρετεί όλες τις παραπάνω υπηρεσίες.

Ωστόσο, κατά τη φάση της υλοποίησης, ενδιαφέρει μόνο το παιχνίδι Joker (ΤΖΟΚΕΡ), οπότε και σύμφωνα με τον παραπάνω πίνακα σημειώσεων πρόκειται για το gameId: 5104

Παράδειγμα 1: Σύμφωνα με τα παραπάνω, για να λάβουμε τα αποτελέσματα της πιο πρόσφατης κλήρωσης/ διαγωνισμού του παιχνιδιού Joker θα χρησιμοποιήσουμε την παρακάτω κλήση:

https://api.opap.gr/draws/v3.0/5104/last-result-and-active

η οποία επιστρέφει τα αποτελέσματα στην παρακάτω μορφή (JSON format) (τα αποτελέσματα ενδέχεται να διαφέρουν ανάλογα με το πότε πραγματοποιήθηκε η κλήση, αφού αφορούν στο πιο πρόσφατο παιχνίδι):

{
    "last": {
        "gameId": 5104,
        "drawId": 2390,
        "drawTime": 1642363200000,
        "status": "results",
        "drawBreak": 1800000,
        "visualDraw": 2390,
        "pricePoints": {
            "amount": 0.5
        },
        "winningNumbers": {
            "list": [
                1,
                29,
                26,
                24,
                17
            ],
            "bonus": [
                6
            ]
        },
        "prizeCategories": [
            {
                "id": 1,
                "divident": 0.0,
                "winners": 0,
                "distributed": 356871.53,
                "jackpot": 748954.15,
                "fixed": 0.0,
                "categoryType": 0,
                "gameType": "Normal",
                "minimumDistributed": 0.0
            },
            {
                "id": 2,
                "divident": 22575.97,
                "winners": 4,
                "distributed": 55178.93,
                "jackpot": 35124.97,
                "fixed": 0.0,
                "categoryType": 0,
                "gameType": "Normal"
            },
            {
                "id": 3,
                "divident": 2500.0,
                "winners": 20,
                "distributed": 50000.0,
                "jackpot": 0.0,
                "fixed": 2500.0,
                "categoryType": 1,
                "gameType": "Normal"
            },
            {
                "id": 4,
                "divident": 50.0,
                "winners": 326,
                "distributed": 16300.0,
                "jackpot": 0.0,
                "fixed": 50.0,
                "categoryType": 1,
                "gameType": "Normal"
            },
            {
                "id": 5,
                "divident": 50.0,
                "winners": 816,
                "distributed": 40800.0,
                "jackpot": 0.0,
                "fixed": 50.0,
                "categoryType": 1,
                "gameType": "Normal"
            },
            {
                "id": 6,
                "divident": 2.0,
                "winners": 16634,
                "distributed": 33268.0,
                "jackpot": 0.0,
                "fixed": 2.0,
                "categoryType": 1,
                "gameType": "Normal"
            },
            {
                "id": 7,
                "divident": 2.0,
                "winners": 10341,
                "distributed": 20682.0,
                "jackpot": 0.0,
                "fixed": 2.0,
                "categoryType": 1,
                "gameType": "Normal"
            },
            {
                "id": 8,
                "divident": 1.5,
                "winners": 49233,
                "distributed": 73849.5,
                "jackpot": 0.0,
                "fixed": 1.5,
                "categoryType": 1,
                "gameType": "Normal"
            }
        ],
        "wagerStatistics": {
            "columns": 2866438,
            "wagers": 503579,
            "addOn": []
        }
    },
    "active": {
        "gameId": 5104,
        "drawId": 2391,
        "drawTime": 1642536000000,
        "status": "active",
        "drawBreak": 1800000,
        "visualDraw": 2391,
        "pricePoints": {
            "amount": 0.5
        },
        "prizeCategories": [
            {
                "id": 1,
                "divident": 0.0,
                "winners": 0,
                "distributed": 0.0,
                "jackpot": 1105825.68,
                "fixed": 0.0,
                "categoryType": 0,
                "gameType": "Normal",
                "minimumDistributed": 1300000.0
            },
            {
                "id": 2,
                "divident": 0.0,
                "winners": 0,
                "distributed": 0.0,
                "jackpot": 0.0,
                "fixed": 0.0,
                "categoryType": 0,
                "gameType": "Normal"
            },
            {
                "id": 3,
                "divident": 0.0,
                "winners": 0,
                "distributed": 0.0,
                "jackpot": 0.0,
                "fixed": 2500.0,
                "categoryType": 1,
                "gameType": "Normal"
            },
            {
                "id": 4,
                "divident": 0.0,
                "winners": 0,
                "distributed": 0.0,
                "jackpot": 0.0,
                "fixed": 50.0,
                "categoryType": 1,
                "gameType": "Normal"
            },
            {
                "id": 5,
                "divident": 0.0,
                "winners": 0,
                "distributed": 0.0,
                "jackpot": 0.0,
                "fixed": 50.0,
                "categoryType": 1,
                "gameType": "Normal"
            },
            {
                "id": 6,
                "divident": 0.0,
                "winners": 0,
                "distributed": 0.0,
                "jackpot": 0.0,
                "fixed": 2.0,
                "categoryType": 1,
                "gameType": "Normal"
            },
            {
                "id": 7,
                "divident": 0.0,
                "winners": 0,
                "distributed": 0.0,
                "jackpot": 0.0,
                "fixed": 2.0,
                "categoryType": 1,
                "gameType": "Normal"
            },
            {
                "id": 8,
                "divident": 0.0,
                "winners": 0,
                "distributed": 0.0,
                "jackpot": 0.0,
                "fixed": 1.5,
                "categoryType": 1,
                "gameType": "Normal"
            }
        ],
        "wagerStatistics": {
            "columns": 0,
            "wagers": 0,
            "addOn": []
        }
    }
} 
Σημείωση: Το παραπάνω αρχείο JSON μπορεί να μελετηθεί και σε συνδυασμό με την ιστοσελίδα (https://www.opap.gr/apotelesmata-klhrwsewn-joker) ως προς την πιο εύκολη κατανόηση της απεικονιζόμενης πληροφορίας.
 
Παράδειγμα 2: Αντίστοιχα, για να λάβουμε τους κωδικούς αποτελεσμάτων, DrawIds, του παιχνιδιού ΤΖΟΚΕΡ για συγκεκριμένο εύρος ημερομηνιών (συγκεκριμένα για 01-12-2021 έως και 31-12-2021) θα χρησιμοποιήσουμε την παρακάτω κλήση:

https://api.opap.gr/draws/v3.0/5104/draw-date/2021-12-01/2021-12-31/draw-id

Κλήση HTTP
Για την κλήση HTTP προτείνεται τη χρήση της βιβλιοθήκης OkHttp. 
Ενδεικτικό παράδειγμα: 

Όλες οι απαντήσεις έρχονται σε μορφή JSON . Επιπλέον, δίδονται οι παρακάτω προδιαγραφές που αφορούν τη λειτουργικότητα τους συστήματος.

Νο	Περιγραφή

R1	
Το σύστημα περιλαμβάνει τις παρακάτω επιλογές:

1.	Διαχείριση δεδομένων ΤΖΟΚΕΡ
2.	Προβολή δεδομένων ΤΖΟΚΕΡ ανά μήνα για συγκεκριμένο έτος
3.	Προβολή στατιστικών δεδομένων ΤΖΟΚΕΡ και εκτύπωση σε αρχείο pdf
4.	Έξοδος

R2	
Με τη διαχείριση των δεδομένων ΤΖΟΚΕΡ εμφανίζεται οθόνη στην οποία ο χρήστης επιλέγει τα δεδομένα που επιθυμεί να αντληθούν από το api. Συγκεκριμένα, επιλέγει είτε το id ενός παιχνιδιού, ώστε να προβληθούν οι λεπτομέρειες για το εν λόγω παιχνίδι, είτε εύρος ημερομηνιών, οπότε προβάλλονται οι λεπτομέρειες για όσα παιχνίδια έχουν γίνει εντός τους εύρους ημερομηνιών. 

Οι λεπτομέρειες που μας ενδιαφέρουν να αντληθούν για κάθε παιχνίδι είναι οι ακόλουθες:

•	Τυχεροί αριθμοί (νικητήρια στήλη)
•	Βασικές κατηγορίες επιτυχιών, όπου για κάθε κατηγορία θέλουμε να γνωρίζουμε τον αριθμό επιτυχιών και τα κέρδη ανά επιτυχία 

Εν συνεχεία, ο χρήστης έχει τη δυνατότητα να αποθηκεύσει τα δεδομένα που ανακτήθηκαν από το api σε ΒΔ. Σε αυτή την περίπτωση προηγείται έλεγχος ύπαρξης στη βάση δεδομένων των δεδομένων αυτών (από προηγούμενη αναζήτηση) και αν δεν υπάρχουν, αποθηκεύονται στη βάση δεδομένων.

Στην οθόνη διαχείρισης των δεδομένων εμφανίζονται επιπλέον τα πλήκτρα «Διαγραφή δεδομένων παιχνιδιού» και «Διαγραφή δεδομένων παιχνιδιών εντός εύρους ημερομηνιών»

Με την επιλογή της διαγραφής δεδομένων παιχνιδιού διαγράφονται από τη βάση δεδομένων τα σχετικά δεδομένα βάζει του id του εν λόγω παιχνιδιού και αντίστοιχα υλοποιείται και η διαγραφή παιχνιδιών εντός ορισμένου εύρους ημερομηνιών.

Η ολοκλήρωση οποιασδήποτε διαγραφής δεδομένων γίνεται αφού προηγηθεί ερώτημα επαλήθευσης με επιβεβαίωση από το χρήστη.

R3	
Στην οθόνη προβολής δεδομένων ΤΖΟΚΕΡ ανά μήνα για συγκεκριμένο έτος ο χρήστης έχει τη δυνατότητα να επιλέξει από μια λίστα τα διαθέσιμα έτη για τα οποία μπορούν να προβληθούν τα δεδομένα του κάθε μήνα. Με την επιλογή ενός έτους, εμφανίζονται οι 12 μήνες και έπειτα σε νέα σελίδα μπορεί ο χρήστης να δει τα συγκεντρωτικά δεδομένα ανά μήνα.
Για κάθε μήνα μας ενδιαφέρουν συγκεντρωτικά δεδομένα, συγκεκριμένα:
•	Πόσα παιχνίδια έγιναν
•	Πόσα χρήματα διανεμήθηκαν
•	Πόσα ΤΖΑΚ-ΠΟΤ έγιναν

R4	
Με την επιλογή προβολής στατιστικών δεδομένων ΤΖΟΚΕΡ και εκτύπωση σε αρχείο pdf, ουσιαστικά χρησιμοποιούμε το api call https://api.opap.gr/games/v1.0/{gameId}/statistics με το gameid του ΤΖΟΚΕΡ, το οποίο επιστρέφει τα στατιστικά των αριθμών που έχουν κληρωθεί σε ένα δοθέν εύρος ημερομηνιών. Τα στατιστικά των αριθμών πρέπει να μπορούν να προβληθούν υπό τη μορφή πίνακα, ενώ στη συνέχεια με την ύπαρξη αντίστοιχης επιλογής, δίνεται η δυνατότητα εκτύπωσης του παραγόμενου πίνακα σε αρχείο PDF.
R5	Αντίστοιχα με την απαίτηση R4, όταν ο χρήστης πατήσει το πλήκτρο «Προβολή στατιστικών στοιχείων κληρώσεων σε γραφική μορφή» εμφανίζεται οθόνη, η οποία παρουσιάζει τα στατιστικά στοιχεία για τα δεδομένα που είναι αποθηκευμένα στη βάση δεδομένων:

•	Συχνότητας εμφάνισης αριθμών (πέντε πιο συχνά εμφανιζόμενοι αριθμοί)
•	Συχνότητα εμφάνισης αριθμών joker (πέντε πιο συχνά εμφανιζόμενοι αριθμοί)
•	Μέσος όρος κερδών ανά κατηγορία  

Επιπλέον, 
•	Ο χρήστης επιλέγει κάθε φορά ποια στατιστικά στοιχεία θα παραχθούν.
•	Υπάρχει δυνατότητα ορισμού του χρονικού διαστήματος για το οποίο θα εμφανιστούν τα στατιστικά στοιχεία. Και εδώ ισχύουν  οι κανόνες διαμόρφωσης ημερομηνιών που αναφέρθηκαν στην απαίτηση R2.
